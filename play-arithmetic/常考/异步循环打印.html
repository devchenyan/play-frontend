<!DOCTYPE html>

<html>
  <body>
    <script>
      // 定时器
      function sleep1(time) {
        return new Promise((resolve) => setTimeout(resolve, time))
      }

      function sleep(time, i) {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            resolve(i)
          }, time)
        })
      }

      async function start() {
        for (let i = 0; i < 10; i++) {
          let num = await sleep(1000, i)
          console.log(num)
        }
      }

      start()
    </script>

    <script>
      // loadImg
      function loadImg(src) {
        return new Promise((resolve, reject) => {
          let img = document.createElement('img')
          img.onload = function() {
            resolve(img)
          }
          img.onerror = function() {
            reject()
          }
          img.src = src
        })
      }

      let result = loadImg('xxxxxxxxxx')

      result.then((res => {
        console.log(res.width)
      }), (err => {
        console.log('failed')
      }))

      result.then(res => {

      })
    </script>
  </body>
</html>